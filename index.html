<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TubeFlow Mobile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #0f0f0f; color: white; -webkit-tap-highlight-color: transparent; }
        .video-card img { transition: opacity 0.2s; }
        .video-card:active img { opacity: 0.7; }
        /* Versteckt Scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animation für den Player */
        #player-overlay { 
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        #player-overlay.active { transform: translateY(0); }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <header class="sticky top-0 bg-[#0f0f0f] z-40 p-3 flex items-center justify-between border-b border-zinc-800">
        <div class="flex items-center gap-2">
            <i class="fab fa-youtube text-red-600 text-2xl"></i>
            <span class="font-bold text-lg tracking-tighter">TubeFlow</span>
        </div>
        <div class="flex gap-4 items-center">
            <i class="fas fa-search text-xl" onclick="toggleSearch()"></i>
            <div class="w-8 h-8 bg-gradient-to-tr from-yellow-400 to-red-500 rounded-full"></div>
        </div>
    </header>

    <div id="searchBar" class="hidden sticky top-[53px] bg-[#0f0f0f] z-40 p-3 border-b border-zinc-800">
        <div class="flex gap-2">
            <input type="text" id="searchInput" placeholder="Videos suchen..." 
                class="w-full bg-zinc-800 rounded-lg px-4 py-2 outline-none focus:ring-1 focus:ring-white">
            <button onclick="searchVideos()" class="bg-zinc-700 px-4 py-2 rounded-lg">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>

    <div class="flex gap-2 p-3 overflow-x-auto no-scrollbar bg-[#0f0f0f]">
        <button onclick="searchVideos('Neuheiten')" class="bg-zinc-800 px-4 py-1.5 rounded-lg text-sm whitespace-nowrap">Alle</button>
        <button onclick="searchVideos('Musik')" class="bg-zinc-800 px-4 py-1.5 rounded-lg text-sm whitespace-nowrap">Musik</button>
        <button onclick="searchVideos('Gaming')" class="bg-zinc-800 px-4 py-1.5 rounded-lg text-sm whitespace-nowrap">Gaming</button>
        <button onclick="searchVideos('Shorts')" class="bg-zinc-800 px-4 py-1.5 rounded-lg text-sm whitespace-nowrap">Shorts</button>
        <button onclick="searchVideos('Technik')" class="bg-zinc-800 px-4 py-1.5 rounded-lg text-sm whitespace-nowrap">Technik</button>
    </div>

    <main id="videoGrid" class="flex-1 p-3 grid grid-cols-1 gap-6 pb-20">
        <div class="animate-pulse space-y-4">
            <div class="bg-zinc-800 aspect-video rounded-xl"></div>
            <div class="h-4 bg-zinc-800 rounded w-3/4"></div>
        </div>
    </main>

    <nav class="fixed bottom-0 w-full bg-[#0f0f0f] border-t border-zinc-800 flex justify-around p-3 z-40 text-[10px]">
        <div class="flex flex-col items-center gap-1" onclick="searchVideos('Trends')">
            <i class="fas fa-house text-lg"></i><span>Home</span>
        </div>
        <div class="flex flex-col items-center gap-1" onclick="searchVideos('Shorts')">
            <i class="fas fa-bolt text-lg"></i><span>Shorts</span>
        </div>
        <div class="flex flex-col items-center gap-1">
            <i class="fas fa-circle-plus text-2xl"></i>
        </div>
        <div class="flex flex-col items-center gap-1">
            <i class="fas fa-layer-group text-lg"></i><span>Abos</span>
        </div>
        <div class="flex flex-col items-center gap-1">
            <i class="fas fa-user-circle text-lg"></i><span>Du</span>
        </div>
    </nav>

    <div id="player-overlay" class="fixed inset-0 bg-black z-50 flex flex-col">
        <div class="p-4 flex items-center">
            <button onclick="closePlayer()" class="text-2xl"><i class="fas fa-chevron-down"></i></button>
        </div>
        <div class="w-full aspect-video bg-zinc-900">
            <iframe id="main-player" width="100%" height="100%" src="" frameborder="0" allowfullscreen allow="autoplay"></iframe>
        </div>
        <div class="p-4">
            <h1 id="player-title" class="text-xl font-bold line-clamp-2">Video Titel</h1>
            <p class="text-zinc-400 text-sm mt-2" id="player-channel">Kanal Name</p>
            <div class="flex gap-4 mt-6">
                <button class="bg-zinc-800 px-4 py-2 rounded-full text-sm"><i class="fas fa-thumbs-up mr-2"></i> Like</button>
                <button class="bg-zinc-800 px-4 py-2 rounded-full text-sm"><i class="fas fa-share mr-2"></i> Share</button>
            </div>
        </div>
    </div>

    <script>
        // Wir nutzen eine öffentliche Invidious Instanz (Keyless!)
        const INVIDIOUS_INSTANCE = "https://invidious.lunar.icu"; 

        function toggleSearch() {
            const bar = document.getElementById('searchBar');
            bar.classList.toggle('hidden');
        }

        async function searchVideos(query = 'Trends') {
            const input = document.getElementById('searchInput').value;
            const searchTerm = input || query;
            const grid = document.getElementById('videoGrid');
            
            // UI Feedback
            grid.innerHTML = '<div class="text-center p-10">Lade Streams...</div>';
            if(!input) document.getElementById('searchBar').classList.add('hidden');

            try {
                // Suche über Invidious API
                const response = await fetch(`${INVIDIOUS_INSTANCE}/api/v1/search?q=${encodeURIComponent(searchTerm)}`);
                const videos = await response.json();
                
                grid.innerHTML = '';
                videos.forEach(v => {
                    if(v.type === "video") {
                        grid.innerHTML += `
                            <div class="video-card" onclick="openPlayer('${v.videoId}', '${v.title.replace(/'/g, "")}', '${v.author}')">
                                <div class="relative">
                                    <img src="${v.videoThumbnails[0].url}" class="w-full aspect-video object-cover rounded-xl bg-zinc-800">
                                    <span class="absolute bottom-2 right-2 bg-black/80 text-[10px] px-1 rounded">${Math.floor(v.lengthSeconds/60)}:${v.lengthSeconds%60}</span>
                                </div>
                                <div class="flex gap-3 mt-3">
                                    <div class="w-10 h-10 bg-zinc-700 rounded-full flex-shrink-0"></div>
                                    <div class="flex-1">
                                        <h3 class="font-bold text-sm leading-snug line-clamp-2">${v.title}</h3>
                                        <p class="text-zinc-400 text-[12px] mt-1">${v.author} • ${v.viewCountText}</p>
                                    </div>
                                    <i class="fas fa-ellipsis-vertical text-zinc-400 pt-1"></i>
                                </div>
                            </div>
                        `;
                    }
                });
            } catch (error) {
                grid.innerHTML = '<div class="p-10 text-red-500 text-center">Fehler beim Laden. Instanz überlastet.</div>';
            }
        }

        function openPlayer(id, title, channel) {
            const overlay = document.getElementById('player-overlay');
            document.getElementById('main-player').src = `https://www.youtube.com/embed/${id}?autoplay=1`;
            document.getElementById('player-title').innerText = title;
            document.getElementById('player-channel').innerText = channel;
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closePlayer() {
            const overlay = document.getElementById('player-overlay');
            overlay.classList.remove('active');
            document.getElementById('main-player').src = '';
            document.body.style.overflow = 'auto';
        }

        // Suche mit Enter
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') searchVideos();
        });

        // Initialer Load
        searchVideos('Aktuelle Musik');
    </script>
</body>
</html>
